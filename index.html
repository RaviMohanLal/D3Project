<!DOCTYPE html >
<html>
<head>
    <meta charset="utf-8">
    <script type ="text/javascript" src="d3.v4.js"></script>
    <style>
        body {
            /* background: #010101; */
  height: 100%;
  margin: 0;
  padding: 0;
}
        .towns{
            fill: rgba(17, 210, 107, 0.685);
        stroke: rgb(213, 28, 28);
        stroke-width: 1px;
        }


.country{
    stroke: #39760de1;
        stroke-width: 0.5;
}

.texta{
    font-family: 'Comic Sans MS', 'Papyrus', sans-serif;
	font-size: 32px;
	font-weight: bold;
	fill: rgb(0, 208, 255);
}

    </style>
</head>


<body>
<div id="map">
    
</div>


<div class="row g-3 mt-4">
<div class="col-md-12">
<label for="sliderId" class="form-label fw-bold"> Cities Increment</label>
<input type="range" id="sliderId" class="form-range" min="0" max="50" step="5" value="10">
<h1 id="demo" style="color: rgba(205, 75, 23, 0.841);"></h1>
</div>
<div class="col-md-12">
</div>
</div>
<script>
 var margin = {top: 0, left:0,right:0,bottom:0},
 height = 900,
 width = 900;
 




 var svg = d3.select("#map")
 
 .append("svg")
 
 .attr("height", height)
 .attr("width", width)
 .append("g")
 .attr("id","svg_id")
 
 function gbmap(value) {
var prjctn = d3.geoNaturalEarth1()
.translate([width/2, height/2])
 .scale(3000)
 .center([-3, 58])
var path = d3.geoPath().projection(prjctn);

 d3.json('https://yamu.pro/gb.json', function(error, data) {
console.log(data);

svg.selectAll("pop")
.data(data.features)
.enter().append("path")
// Red map colour of Britain
.attr("fill", "Red")
.attr("class","country")
.attr("d",path)
//Great Britian defualt title on mouse hover
.append('title')
.text("Great Britain");
 });

 

const topjson = 'http://34.78.46.186/Circles/Towns/'
 d3.json(topjson + value, function(error, data) {
console.log(data);
svg.selectAll('.towns')
.data(data)
.enter().append('circle')

.attr("class","towns")
//radius of each town
.attr("r", 5)
.attr("cx",function(d){
    console.log(d);
    var coords = prjctn([d.lng, d.lat])
    return coords[0];
})
.attr("cy",function(d){
    var coords = prjctn([d.lng, d.lat])
    return coords[1]
})
.append("title")
.text((d) => d.County);
 });




// code commented for text without circles 


//  d3.json('http://34.78.46.186/Circles/Towns/10', function(error, data) {
// console.log(data);
// svg.selectAll('.towns')
// .data(data)
// .enter().append('text')
// .attr("class","texta")
// .text(function(d) {return d.County})
// .attr('x', function(d){ return prjctn([d.lng, d.lat])[0];})
// .attr('y', function(d){ return prjctn([d.lng, d.lat])[1];})
//  });

var rangeslider = document.getElementById("sliderId");
var mapDiv = document.getElementById("svg_id");
var reloadBtn = document.getElementById("reloadBtn");
var output = document.getElementById("demo");
output.innerHTML = rangeslider.value;
rangeslider.oninput = function() {
  output.innerHTML = this.value;
  reloadBtn.setAttribute("data-id",this.value);
  mapDiv.innerHTML = "";
  ukMap(this.value);

}
 }
 //on load 10 cities on default
window.onload =  gbmap(10);
</script>
</body>
</html>